<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.ReviewMapper">
	
	<insert id="insertReview" parameterType="review">
		insert into review (place_id,member_num,stars,content,created_at) values (#{place_id},#{member_num},#{stars},#{content},now())
	</insert> 
	<delete id="deleteReview">
		delete from review where num=#{num}
	</delete>
	<update id="updateReview" parameterType="review">
		update review set stars=#{stars},content=#{content} where num=#{num}
	</update>
	<!--  <select id="getTotalCount" resultType="int">
		select count(*) from reactboard
	</select>
	<select id="getPagingList" resultType="board" parameterType="Map">
		select * from reactboard order by num desc limit #{start},#{perpage}
	</select>-->
	
	<select id="getAllDatas" resultType="review" parameterType="String">
		SELECT review.num,place_id,review.member_num,member.name,stars,content,created_at FROM review, `member` where place_id=#{place_id} and review.member_num = member.num order by review.created_at desc
	</select>
	<select id="getAvgStars" parameterType="String" resultType="double">
		SELECT truncate(avg(stars),2) from review where place_id=#{place_id}
	</select>
	
	 <select id="getData" resultType="review" parameterType="int">	
		select review.num,place_id,review.member_num,member.name,stars,content,created_at from review, `member` where review.num=#{num} and review.member_num = member.num
	</select> 
	<!-- 상세보기-->
</mapper>